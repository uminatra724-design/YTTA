<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTTP STRESS ANALYZER - REAL REQUEST MODE</title>
    <style>
        :root {
            --danger-red: #ff4444;
            --warning-yellow: #ffaa00;
            --safe-green: #00cc66;
            --dark-bg: #0d1117;
            --darker-bg: #010409;
            --border-color: #30363d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: var(--dark-bg);
            color: #e6edf3;
            min-height: 100vh;
            padding: 20px;
        }
        
        .warning-banner {
            background: linear-gradient(90deg, #220000, #440000);
            border: 2px solid var(--danger-red);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.3);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .panel {
            background: var(--darker-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .panel-title {
            color: var(--danger-red);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #8b949e;
            font-size: 14px;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            background: #161b22;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: #e6edf3;
            font-size: 14px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--danger-red);
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.2);
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #238636, #2ea043);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #2ea043, #3fb950);
            box-shadow: 0 0 20px rgba(46, 160, 67, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #da3633, #f85149);
            color: white;
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #f85149, #ff7b72);
            box-shadow: 0 0 20px rgba(248, 81, 73, 0.4);
        }
        
        .btn-stop {
            background: linear-gradient(135deg, #8e1515, #da3633);
            color: white;
        }
        
        .btn-stop:hover {
            background: linear-gradient(135deg, #da3633, #f85149);
            box-shadow: 0 0 20px rgba(218, 54, 51, 0.4);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .metric-box {
            background: #161b22;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 15px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--danger-red);
            margin: 5px 0;
        }
        
        .metric-label {
            font-size: 12px;
            color: #8b949e;
            text-transform: uppercase;
        }
        
        .progress-bar {
            height: 8px;
            background: #161b22;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #da3633, #f85149);
            width: 0%;
            transition: width 0.3s;
        }
        
        .log-console {
            background: #0a0c10;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            height: 300px;
            overflow-y: auto;
            padding: 10px;
            font-family: 'Cascadia Code', 'Consolas', monospace;
            font-size: 12px;
        }
        
        .log-entry {
            padding: 4px 0;
            border-bottom: 1px solid rgba(48, 54, 61, 0.3);
        }
        
        .log-time {
            color: #8b949e;
            margin-right: 10px;
        }
        
        .log-success { color: #3fb950; }
        .log-error { color: #f85149; }
        .log-warning { color: #e3b341; }
        .log-info { color: #58a6ff; }
        
        .config-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .toggle-switch {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
            margin-right: 10px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #30363d;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #238636;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-active { background: var(--danger-red); box-shadow: 0 0 10px var(--danger-red); }
        .status-idle { background: var(--safe-green); }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="warning-banner">
        <h2>⚠ PERINGATAN KESELAMATAN EKSTRIM ⚠</h2>
        <p><strong>ALAT INI AKAN MENGIRIM REQUEST NYATA KE TARGET.</strong> Penggunaan untuk target tanpa izin adalah:</p>
        <ul>
            <li>⛔ MELANGGAR UU ITE Pasal 30-32 (Indonesia)</li>
            <li>⛔ MELANGGAR Computer Fraud and Abuse Act (AS)</li>
            <li>⛔ PELANGGARAN hukum siber di hampir semua negara</li>
            <li>⛔ DAPAT dikenakan pidana penjara dan denda besar</li>
        </ul>
        <p><strong>Hanya gunakan pada server yang Anda miliki atau memiliki izin tertulis!</strong></p>
    </div>

    <div class="container">
        <!-- KOLOM KIRI: KONFIGURASI -->
        <div class="panel">
            <div class="panel-title">KONFIGURASI TARGET</div>
            
            <div class="input-group">
                <label for="targetUrl">URL TARGET</label>
                <input type="text" id="targetUrl" placeholder="https://example.com" value="">
            </div>
            
            <div class="input-group">
                <label for="requestMethod">METODE REQUEST</label>
                <select id="requestMethod">
                    <option value="GET">GET</option>
                    <option value="POST" selected>POST</option>
                    <option value="PUT">PUT</option>
                    <option value="DELETE">DELETE</option>
                    <option value="HEAD">HEAD</option>
                </select>
            </div>
            
            <div class="config-grid">
                <div class="input-group">
                    <label for="threadCount">THREAD / WORKER</label>
                    <input type="number" id="threadCount" value="50" min="1" max="200">
                </div>
                
                <div class="input-group">
                    <label for="requestDelay">DELAY (ms)</label>
                    <input type="number" id="requestDelay" value="10" min="0" max="1000">
                </div>
            </div>
            
            <div class="input-group">
                <label for="timeoutDuration">TIMEOUT (detik)</label>
                <input type="number" id="timeoutDuration" value="5" min="1" max="30">
            </div>
            
            <div class="toggle-switch">
                <label class="switch">
                    <input type="checkbox" id="keepAlive" checked>
                    <span class="slider"></span>
                </label>
                <span>Keep-Alive Connection</span>
            </div>
            
            <div class="toggle-switch">
                <label class="switch">
                    <input type="checkbox" id="randomAgent" checked>
                    <span class="slider"></span>
                </label>
                <span>Random User-Agent</span>
            </div>
            
            <div class="toggle-switch">
                <label class="switch">
                    <input type="checkbox" id="autoStop" checked>
                    <span class="slider"></span>
                </label>
                <span>Auto Stop (setelah 10k requests)</span>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
                <button class="btn btn-primary" onclick="startTest()">
                    MULAI TEST
                </button>
                <button class="btn btn-stop" onclick="stopTest()" id="stopBtn" disabled>
                    STOP TEST
                </button>
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background: #161b22; border-radius: 6px;">
                <h4>STATUS: <span id="statusText">IDLE</span> <span class="status-indicator status-idle" id="statusIndicator"></span></h4>
            </div>
        </div>
        
        <!-- KOLOM KANAN: METRIK & MONITOR -->
        <div class="panel">
            <div class="panel-title">METRIK REAL-TIME</div>
            
            <div class="metrics-grid">
                <div class="metric-box">
                    <div class="metric-label">TOTAL REQUESTS</div>
                    <div class="metric-value" id="totalRequests">0</div>
                </div>
                
                <div class="metric-box">
                    <div class="metric-label">SUCCESS</div>
                    <div class="metric-value" id="successCount">0</div>
                </div>
                
                <div class="metric-box">
                    <div class="metric-label">ERROR</div>
                    <div class="metric-value" id="errorCount">0</div>
                </div>
                
                <div class="metric-box">
                    <div class="metric-label">REQ/SECOND</div>
                    <div class="metric-value" id="reqPerSec">0</div>
                </div>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span>Success Rate: <span id="successRate">100%</span></span>
                <span>Elapsed: <span id="elapsedTime">00:00</span></span>
            </div>
            
            <div class="panel-title" style="margin-top: 30px;">LIVE LOG</div>
            <div class="log-console" id="logConsole">
                <div class="log-entry log-info">
                    <span class="log-time">[00:00:00]</span> System initialized. Ready for configuration.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let isRunning = false;
        let abortController = null;
        let totalRequests = 0;
        let successRequests = 0;
        let errorRequests = 0;
        let startTime = null;
        let workers = [];
        
        // User-Agent pool
        const userAgents = [
            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',
            'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36',
            'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/537.36',
            'Mozilla/5.0 (Android 10; Mobile) AppleWebKit/537.36',
            'Googlebot/2.1 (+http://www.google.com/bot.html)',
            'Mozilla/5.0 (compatible; Bingbot/2.0; +http://www.bing.com/bingbot.htm)'
        ];
        
        // Log system
        function log(message, type = 'info') {
            const console = document.getElementById('logConsole');
            const now = new Date();
            const timeStr = `[${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}:${now.getSeconds().toString().padStart(2,'0')}]`;
            
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.innerHTML = `<span class="log-time">${timeStr}</span> ${message}`;
            
            console.appendChild(entry);
            console.scrollTop = console.scrollHeight;
            
            // Keep only last 100 entries
            if(console.children.length > 100) {
                console.removeChild(console.firstChild);
            }
        }
        
        // Update metrics
        function updateMetrics() {
            document.getElementById('totalRequests').textContent = totalRequests.toLocaleString();
            document.getElementById('successCount').textContent = successRequests.toLocaleString();
            document.getElementById('errorCount').textContent = errorRequests.toLocaleString();
            
            const elapsed = (Date.now() - startTime) / 1000;
            const rps = elapsed > 0 ? (totalRequests / elapsed).toFixed(1) : '0';
            document.getElementById('reqPerSec').textContent = rps;
            
            const successRate = totalRequests > 0 ? ((successRequests / totalRequests) * 100).toFixed(1) : '100';
            document.getElementById('successRate').textContent = `${successRate}%`;
            
            // Update progress bar
            const progress = Math.min(totalRequests / 10000 * 100, 100);
            document.getElementById('progressFill').style.width = `${progress}%`;
            
            // Update elapsed time
            if(startTime) {
                const seconds = Math.floor(elapsed);
                const minutes = Math.floor(seconds / 60);
                const secs = seconds % 60;
                document.getElementById('elapsedTime').textContent = `${minutes.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            }
        }
        
        // Make a single HTTP request
        async function makeRequest(url, method, timeout) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeout * 1000);
            
            const headers = {
                'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
                'Accept-Language': 'en-US,en;q=0.5',
                'Connection': document.getElementById('keepAlive').checked ? 'keep-alive' : 'close',
                'Cache-Control': 'no-cache',
                'Pragma': 'no-cache'
            };
            
            if(document.getElementById('randomAgent').checked) {
                headers['User-Agent'] = userAgents[Math.floor(Math.random() * userAgents.length)];
            }
            
            try {
                const start = performance.now();
                const response = await fetch(url, {
                    method: method,
                    headers: headers,
                    mode: 'no-cors', // Important for cross-origin requests
                    signal: controller.signal,
                    credentials: 'omit'
                });
                
                const end = performance.now();
                const latency = (end - start).toFixed(1);
                
                // With no-cors mode, we can't read response status
                return {
                    success: true,
                    latency: latency,
                    status: 'Sent'
                };
                
            } catch (error) {
                return {
                    success: false,
                    error: error.name === 'AbortError' ? 'Timeout' : error.message,
                    latency: null
                };
            } finally {
                clearTimeout(timeoutId);
            }
        }
        
        // Worker function
        async function worker(workerId, url, method, delay, timeout) {
            while(isRunning && abortController && !abortController.signal.aborted) {
                if(!isRunning) break;
                
                const result = await makeRequest(url, method, timeout);
                
                totalRequests++;
                if(result.success) {
                    successRequests++;
                    log(`Worker ${workerId}: Request sent (${result.latency}ms)`, 'success');
                } else {
                    errorRequests++;
                    log(`Worker ${workerId}: ${result.error}`, 'error');
                }
                
                updateMetrics();
                
                // Check auto-stop condition
                if(document.getElementById('autoStop').checked && totalRequests >= 10000) {
                    log(`Auto-stop triggered: reached 10,000 requests`, 'warning');
                    stopTest();
                    break;
                }
                
                // Add delay between requests
                if(delay > 0) {
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        }
        
        // Start test
        async function startTest() {
            const url = document.getElementById('targetUrl').value.trim();
            const method = document.getElementById('requestMethod').value;
            const threadCount = parseInt(document.getElementById('threadCount').value);
            const delay = parseInt(document.getElementById('requestDelay').value);
            const timeout = parseInt(document.getElementById('timeoutDuration').value);
            
            if(!url) {
                alert('Masukkan URL target terlebih dahulu!');
                return;
            }
            
            if(!url.startsWith('http://') && !url.startsWith('https://')) {
                alert('URL harus diawali dengan http:// atau https://');
                return;
            }
            
            // Final warning
            if(!confirm(`⚠ PERINGATAN AKHIR ⚠\n\nAnda akan mengirim request NYATA ke:\n${url}\n\nDengan konfigurasi:\n• ${threadCount} worker thread\n• Metode: ${method}\n• Delay: ${delay}ms\n\nAPAKAH ANDA YAKIN?\n\nPastikan Anda memiliki IZIN untuk menguji server ini!`)) {
                return;
            }
            
            // Reset metrics
            totalRequests = 0;
            successRequests = 0;
            errorRequests = 0;
            startTime = Date.now();
            
            // Start test
            isRunning = true;
            abortController = new AbortController();
            
            document.getElementById('statusText').textContent = 'RUNNING';
            document.getElementById('statusIndicator').className = 'status-indicator status-active';
            document.getElementById('stopBtn').disabled = false;
            
            log(`Test dimulai ke: ${url}`, 'warning');
            log(`Konfigurasi: ${threadCount} worker, ${method} method, ${delay}ms delay`, 'info');
            log(`Peringatan: Request NYATA sedang dikirim!`, 'error');
            
            // Start workers
            workers = [];
            for(let i = 0; i < threadCount; i++) {
                workers.push(worker(i + 1, url, method, delay, timeout));
            }
            
            // Monitor progress
            const interval = setInterval(() => {
                if(!isRunning) {
                    clearInterval(interval);
                    return;
                }
                updateMetrics();
            }, 500);
        }
        
        // Stop test
        function stopTest() {
            if(!isRunning) return;
            
            isRunning = false;
            
            if(abortController) {
                abortController.abort();
            }
            
            document.getElementById('statusText').textContent = 'STOPPED';
            document.getElementById('statusIndicator').className = 'status-indicator status-idle';
            document.getElementById('stopBtn').disabled = true;
            
            const duration = ((Date.now() - startTime) / 1000).toFixed(1);
            const successRate = totalRequests > 0 ? ((successRequests / totalRequests) * 100).toFixed(1) : '0';
            
            log(`Test dihentikan setelah ${duration} detik`, 'warning');
            log(`Total requests: ${totalRequests.toLocaleString()}`, 'info');
            log(`Success rate: ${successRate}%`, totalRequests > 0 && successRate > 90 ? 'success' : 'warning');
            
            // Generate summary
            console.log(`=== TEST SUMMARY ===`);
            console.log(`Target: ${document.getElementById('targetUrl').value}`);
            console.log(`Duration: ${duration}s`);
            console.log(`Total Requests: ${totalRequests}`);
            console.log(`Successful: ${successRequests}`);
            console.log(`Failed: ${errorRequests}`);
            console.log(`Success Rate: ${successRate}%`);
            console.log(`Requests/sec: ${(totalRequests / duration).toFixed(1)}`);
            console.log(`===================`);
        }
        
        // Handle page unload
        window.addEventListener('beforeunload', (e) => {
            if(isRunning) {
                e.preventDefault();
                e.returnValue = 'Test masih berjalan. Yakin ingin meninggalkan halaman?';
                return 'Test masih berjalan. Yakin ingin meninggalkan halaman?';
            }
        });
        
        // Auto-cleanup
        window.addEventListener('unload', () => {
            if(isRunning) {
                stopTest();
            }
        });
        
        // Initialize
        log('HTTP Stress Tester v1.0 - REAL REQUEST MODE', 'info');
        log('⚠ WARNING: This tool sends REAL HTTP requests', 'error');
        log('Use only on servers you own or have written permission!', 'warning');
    </script>
</body>
</html>